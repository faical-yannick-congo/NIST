###################################################
# About
# Date: April 21, 2017
# Description:
# CrowdVar Data
# Goal: Generate new TSV files for CrowdVariant high confidence sites
# Rationale
# Problem: no complete bed file containing ALL variant sites
# Problem: tried processing tsv files from the verily2techfiltremain folder, and output bedfile not synchronized
# Problem: bed files in verily2techfiltremain folder are incomplete/unlabeled/unexpected format
#          Bed Files crowd_variant_regions_remaining_2_tech_filt.bed, verily2techfiltremain_svvizGT.bed, /Volumes/lesleydata/AJTrio/verily2techfiltremain/verily2techfiltremain_svvizGTallcol.txt
# Problem: Closest to complete bed file is 'crowd_variant_regions_sets_combined_svvizGTallcol'
# Problem: start sites are 1 off from union VCF (1 greater than start sites in union VCF)
# Solution: 
# 1. Take CrowdVariant labeled points and subtract 1 from all start sites. These are the 1700+ crowd labeled points from the publication (/Users/lmc2/Desktop/NIHFAES/FinalProject/Train/CrowdVar_labeled.csv)
# 2. Select start sites that match between unionVCF and start sites (-1) CrowdVar High confidence list 
# 3. Run sites through svviz and collect new tsv files --> process in R and python

###################################################
# Imports 
###################################################
import pandas as pd
import random
import numpy as np

###################################################
# Data 
###################################################

# Load/Parse .txt file using pd.read_table()
colnames = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J']
df = pd.read_table('/Users/lmc2/Desktop/NIHFAES/FinalProject/Train/Data2/union_refalt.sort.Awk_SED_formattedforsvviz.txt', names=colnames)
# print df.head(5)
# print len(df)

results = pd.DataFrame()
df[df['B'].isin([10762491])]
# print df.head()

df[(df['B'] == 10762491)]


# Determine whether part of a number is contained in a longer string of numbers
df['B'].astype(str)
# print df.dtypes
matches = '184220483|23743258|23910885|106983634|58034593|127192204|27622700|168895804|36160124|39084335|43226732|138966210|9634638|75429885|6068847|42676125|35627127|14910417|26344478|66810627|17597834|192744353|42165940|76526498|241863591|10404559|18286559|170641506|72356552|59607590|214775201|76611500|25670021|184674442|68713337|36133507|108120233|31193546|189224507|13895090|101894145|98345117|167488070|19410242|3502325|3037866|129184467|37293817|33492638|156092169|122226880|63272053|1061090|89037668|30899225|58743911|64633178|51406755|106703446|32389261|46956101|39004516|88666173|80205741|103873115|98595390|152809574|214874702|190787075|3021755|160086246|57111291|147606663|33780446|30915522|1995501|88291882|85800410|16171772|164501952|14657709|170278462|4290061|39934175|124943566|8937847|24090796|109976710|1746464|60341396|32390150|64971200|32778753|124363834|12002319|54463232|4066923|158867529|43977459|178855458|18612328|844884|10493409|132335224|64413375|42155114|85519119|33583196|118281603|44970363|122056874|27050040|132026685|11682892|25117140|3173226|11411666|81008179|1108794|46113682|113854019|25030886|160149116|77574164|111516317|17684764|76870502|245778200|2726368|36362881|41818194|136060726|168806477|132534386|110018276|104894045|25158702|98133375|11556104|4122883|191264386|171190122|61944785|96730343|52948967|115768100|55429892|56834969|101494728|59985385|127766426|30106622|102163352|483142|188539453|107950682|12289109|6400507|23760232|114056494|242927696|42024611|66711488|46278652|76202118|221038200|34290046|139612581|223760177|162408308|4081264|31287504|136854715|33141249|198894512|83676072|82929312|70190686|78575352|136851623|188959364|6729117|1402321|108030316|178287636|60658000|6163199|96067512|23047774|19326825|32806746|47388027|4980306|33403529|77524150|57957698|14189909|149878073|62082855|47657351|33723406|125867371|45775809|95498972|75911487|38377922|52367500|31725177|208474484|171901379|46202794|150951038|33204100|11822986|120488897|140253508|52412370|42346258|106695075|221882972|145931898|894396|83125958|89036480|101543500|46153178|34641621|31492866|86310522|71437834|66532438|28897468|197500519|16597561|41516989|24903697|52888815|1178293|177445110|73828443|203887666|24710952|10273605|83853114|81907490|194398491|104569694|199438725|107624913|80925311|36662636|132988684|22881665|25777304|88139119|89275797|31443350|64538786|22435737|22908972|7134678|46910148|7583515|209061166|96010455|100609948|170130035|186441631|1366533|2909421|88862630|10260048|99759460|6277340|1182616|84042282|37477277|103322483|171362506|22202730|26311085|46349015|130123024|79610354|16996167|72568199|13169570|11903450|144513578|3780614|39267014|97292899|43053307|101693850|56851591|48990525|72152426|109730161|147832800|84237970|23922249|83750956|110498738|85617808|133134660|154941913|84221717|33572779|99574482|43750691|29954757|42238051|15394895|160855861|98181275|86396663|62624363|72753296|93578003|236094668|131917569|76126886|99174327|225292950|6230176|52107107|32291233|107728553|36780614|111383198|72385965|139207159|46097991|43549343|2311586|113683111|149575928|115130455|69959841|65346054|5487780|35191148|40446944|2122082|167546015|13017632|189575892|5106962|66135714|124836859|100260128|60589089|28972219|119330248|91237575|24376836|72639095|74269383|19178176|44901308|143167707|21587714|79844898|170210022|142230777|13220475|118265322|121059230|49801158|124717356|31419892|121319292|196031309|32153719|31342723|20666663|130066124|60570636|64286052|93021138|49197762|48948718|57300200|154446929|43931493|84723182|102069440|29837536|78800909|12556832|47887666|65642110|157002030|45635403|92969229|97401560|42356978|22892492|68890213|469447|162208875|74288220|33115809|56676276|49709182|68603031|53616477|184125373|104465979|9411772|37050883|69049580|41183193|140014070|48944597|158596570|65185160|150302656|26767939|34376278|125671736|677316|25721015|80081392|181317271|24207055|7347022|43261001|61880171|31327359|4222047|150759307|58617769|103463064|74755166|104416307|71583555|29722594|146042937|79911586|54565492|32963597|41031542|154096733|7791230|107400986|60032092|92245995|6025735|92807994|7716913|4708517|62015482|23140800|57474905|66641109|1654669|19996063|44359411|23635492|13739080|81469113|81556181|62706091|32749230|15885447|131411955|27375674|28247805|56617023|6700368|133619888|142935364|12851180|86284306|30491281|73753605|61293624|30024539|9162575|113953499|89154552|5933615|241186302|59059632|52525181|67974875|27483240|9519811|23528551|58343221|186155538|86660753|108031341|104010482|117059337|85748632|59283860|205439855|65727352|32203876|65618413|61365481|9146636|37002874|22796608|43031104|114214525|109243703|61203704|30986506|70634336|25227627|23173184|121087087|166267506|118223529|96614759|38150740|37816472|115628104|24091620|72829624|92910650|135476979|2332945|124795815|108352844|73784059|30601814|159959787|52802864|42946047|65719084|58166998|62295043|34323110|35306059|153310127|21286126|6790870|70943314|48816867|69806992|6573063|133107688|47318567|82012061|15471088|178550128|105506296|107596185|134673900|31040644|62289713|152100939|49470019|159652107|36108118|103764020|71665321|17209752|17859495|56401215|71078598|20022109|121883599|107511091|1682791|140189284|69790855|90267755|187213948|36955660|190910593|36543612|26383397|7264579|148706621|110694940|158998826|1358007|108266110|117399810|51736108|39384256|75235946|91402096|42911941|111576402|120313016|25204074|77920099|121681670|41822286|5109458|49958454|36423662|144890055|99752962|26005796|71148798|213084230|7717382|52737961|10292745|233364546|43539793|183315804|221345932|26181025|62304701|88775633|2033039|94165640|71741317|105567835|184937051|109721152|28190195|90421365|42838356|38337630|26260584|177405892|121278800|97897192|117251481|135433001|62947783|19291162|3581484|72123604|127027718|68724044|48734732|5457107|144382747|51374713|106813625|33213070|66823191|80614359|179956852|127248955|184754838|140161362|32550166|187464827|114157784|89408836|120881114|159666776|16821878|22227482|160935033|93541815|160670214|66841803|14449038|136803|31175583|11474751|48957952|94657364|34537521|10813066|33200868|82845168|44600176|18242156|73768781|75992378|122141595|42017746|158029472|58596496|161795598|178156836|49979396|163666406|29967577|14227988|40794614|75997281|117700196|102471844|146192868|98783446|1924589|38961713|47696461|41007031|70125042|112430198|81302537|54810770|27961363|24742232|93897296|116750811|1146288|54204894|81687794|37905700|8634163|56151096|105154409|85405339|55808683|19061416|96251539|96470354|210546|73406886|2379470|45473178|78375997|84484484|75557600|37448145|82946462|8848767|116357937|23685994|82889210|145521833|74987528|37014962|49951401|61286429|4537275|159348727|122138440|67122066|21775425|136235625|55971771|47607388|28813574|122289583|104144388|105162483|87901414|164658310|36309279|34728119|32420586|158894686|174198583|46045872|6888773|83179446|96853053|70553022|124170255|20862532|79557186|3885211|82164197|49612880|86144298|31082616|19504656|107198483|5350910|9956833|75845890|48015693|104443959|53084126|88890017|21778184|75082293|104180380|206731197|82936654|110510305|138490115|109489075|59545298|13778071|68008245|162332266|666376|80801689|131700876|32313781|138479099|29661107|77062323|34316367|34517030|19476796|50640218|40028479|195477625|84280617|55941180|159428998|138860548|54208630|818937|81092181|8227921|193355402|76282236|99628781|63743626|18057663|125118000|188505185|46366107|68183093|71107992|105053151|116842001|19643123|136414099|99465140|17202754|167004315|193235428|45429845|44535347|33621653|6700872|5037248|14453234|47689476|180183790|63656191|83350692|116204833|131118979|38099574|100306761|148566800|64542944|65342427|72551416|29332277|142494031|13594462|130901189|70036407|11258524|7995793|187437113|182856912|35315634|208567223|24402985|7832825|59974178|81695834|65807504|134817359|25931394|82737749|7077039|10842333|9323592|192063179|86026363|132081989|134268978|29633085|66960939|90499771|192562188|62704436|164366310|180173589|6587834|21849901|104278197|47880229|78095087|81725776|72956722|159742555|100151300|41271109|101990874|138742280|71926410|62046859|105825906|14470517|89681471|75669528|119447044|38630799|158719075|23055217|89424146|154619989|112617742|223481704|82201947|10708535|24932619|144056646|18873311|51776406|27433985|77959650|30392275|54213952|54864376|21536142|131694837|105097522|68936887|190253838|51256298|77337380|72571426|154817447|158488408|101334183|43891827|24712918|88032010|54860808|67083770|57702023|65134841|114466474|11826267|159648706|64903298|79742088|61553031|96791001|178839248|223797356|109803450|74074919|144871902|10504315|5534545|6663300|26955950|150693567|104129513|27804112|76294910|9525807|23103301|26891517|7524475|31942993|81346080|145127690|15942647|83179789|38208243|147730177|39737278|240838630|84005626|122531843|77105230|35250485|121401684|24374795|1097750|43909593|65060925|12557696|6036573|147553038|12281701|238852315|17230379|19543415|52023759|46817539|22186551|203684326|28421589|82156714|37857255|93883360|7542307|154411689|84593107|8243043|33716057|61999375|117711615|1654501|1047090|121797444|40010672|25044611|8934742|8187616|52520171|8066619|3141443|73648994|104999606|6524388|121808927|170808437|231325292|213574684|13944335|59044768|194290283|21694729|97572100|15323277|124498906|4050239|95545476|42023935|127502636|85272559|140952890|239902388|78527299|33355561|34022527|68846739|54780320|61202684|40794223|27657261|85033857|74865544|179607280|14732343|35614173|31152431|116275269|119893983|50136448|74964925|169725871|87858054|193130900|88164707|1923870|69943723|59096465|26212029|206845196|93515796|136065718|9950426|89860419|86564381|14451265|7905946|2769421|95335622|52175928|21651566|174533059|112467399|27307884|34390307|51926584|68727320|170431655|51551932|9385389|40697281|20662587|36438404|6150943|115937095|88043142|114934391|18755817|39129001|98110642|69078393|107974328|126942344|194121162|79673737|49518023|32377845|63723803|117868221|4376417|106449322|105708088|70946187|10462404|198773748|37414465|14258601|62489951|104219693|146057021|48645208|29624707|39906512|5623546|176478217|29411472|44509375|207292361|76557055|13882549|11484967|153805375|113225848|177869318|74798369|116428182|103394012|47720632|79891855|146622649|139948014|22047473|52709835|15761936|103062315|111559426|71828461|79878597|56967314|4535386|17195839|66263909|155311787|88285761|62815113|104990325|89392205|151057990|90858982|60412345|99623700|29918521|57031207|141491723|240392998|9959235|24804536|41336679|25241047|28839864|19748084|6688208|111808767|9225120|170119564|49976224|137313691|56824085|103916404|99089508|44507273|83949281|23407217|91173972|51691895|11068045|138200160|6847401|150789788|131928478|112168225|98721236|158050712|246877706|6006196|94638739|14529080|65947329|21903362|231996174|105733991|158876074|54524063|30371315|120727435|71885473|128989814|99185513|190291429|53700963|54245420|48725465|113790936|12102200|196051812|31291354|20477955|102787785|111295210|71895471|195830391|81747234|51436062|36842758|105260827|4874862|46005378|84400754|31338485|132278715|82963291|14075621|223785|195297137|26825144|2778565|33797393|18283894|56887700|145019621|152340703|50921353|33477172|71164361|119015142|13775637|21990741|55893665|188994962|190837319|80751154|141055219|34192589|80062865|123515068|38245235|106670516|73221939|81991513|98974016|68797621|31813874|85955653|181876801|1063839|74769768|48880715|32795502|54856211|7793812|113459035|10834755|108884762|53086336|76773553|194350507|101309042|54081756|19423613|100034500|28869845|24571618|12152542|69400840|93352153|11389019|122232647|148506312|6651589|104187382|75435661|19258020|130959394|54556433|77048343|66311346|50699869|7822869|3581047|107253000|114969336|82904655|70734796|148844370|128932240|29476930|47490666|1866351|35815609|40098408|9016840|17103449|8326055|83372963|879150|56604698|102815121|49494285|5324644|30345787|51831868|123048406|72393121|150083879|128037992|60786161|54122550|45609843|33708273|161605041|59078462|94669332|184768869|81049847|75245848|34643628|63597634|9338352|158433335|17444825|83275283|95343324|70690066|123489180|102810349|8414600|15166285|30289448|86213401|124890052|11379620|86464793|157173863|149463911|65637806|33391971|45099892|67602984|98706089|167108087|7221931|98784002|23478574|32463653|26512937|106324750|61574781|42271853|7968662|31523764|18959833|241691690|134132648|801625|144108804|77215855|67949608|130836869|35401400|24038164|70552550|69966660|53594098|134346775|19902304|83630437|16264809|130626374|33259000|88821956|53702931|132168281|8514408|196214812|60172497|48772774|103087926|188215716|61724697|95193323|9036096|83019615|105221951|166294141|9014814|31590269|180097877|53617872|114756514|10828091|126681373|61607113|76011865|26079290|65527144|81441657|20460058|184303689|66260038|42464104|42156149|136379220|11875550|16420122|90574693|101357564|85149487|100844995|34827013|25827874|141325705|120263688|138742963|74632733|203894312|59018045|113085434|32540598|64339232|134888211|50925975|85626222|16251104|152041202|71444205|85375928|51199471|154064578|71242337|5209188|39057318|110234717|196158046|16847393|19002873|50612384|45150261|200312453|66633810|12027430|13855298|36733249|108560528|41659829|170992012|39469286|58087344|63301184|45875020|48508940|6538387|47075364|26701607|143494778|78276762|176506084|81358335|122274352|144888448|55429274|34514025|17894168|31310880|15532464|81194339|5942985|99923531|9990097|86659206|153133706|62190932|20667243|128420262|81182488|161684134|100675959|48334239|104474000|128976345|37046193|114393663|85522714|25432502|151903081|28564284|108835056|8698626|151485866|19078554|190478456|69852137|127674755|11509704|12596187|36441168|57779820|36469904|128106470|27514335|7257581|42761076|33093407|108501444|45768351|8720160|159257020|5748174|37061630|15460544|61621925|126468005|37885500|13827952|63151826|146438805|78117889|96382452|158548264|2600690|87066366|164176122|33898854|6999375|76614302|6097384|153165972|74145055|6881364|15365283|73824504|152617191|81173836|34632671|49552073|243782744|87911911|26354756|131120720|161635509|71777926|7012507|103261878|19230440|103940657|184257869|22069954|121273808|69896767|39765314|26608220|99608147|128379089|119634281|72189158|53292649|132083624|23007838|11341899|42585909|6355680|83709876|70998115|33423361|61945874|71602356|67404503|168742521|4346656|180063817|35645164|80110684|2864014|197614630|124642001|191038446|169160018|77100364|39744389|75988296|233668369|122357095|35051661|241360537|70786329|1028785|2798772|127172328|185665771|119417517|140608587|179120333|131226956|19676603|50000946|74312430|62002276|1602956|54015843|15053403|43751805|75828391|231207810|105773512|18661282|15892152|52094972|28167456|163062261|18099514|182056557|74932721|88091297|60062713|152778522|146883957|195569215|48690001|109101753|175090638|13663191|25068855|120017251|90468259|24107712|74534291|103030565|115997804|33751615|161818064|18454610|62044536|70195013|58912863|76032927|90454978|51517347|2472722|102751104|131677811|122301643|72977696|23320801|38953621|104060207|166002604|8325637|89262580|25098087|20765364|39607652|14632538|34200447|22434802|1951012|70013474|54946736|31205813|55482417|14531290|106938450|150161054|49359569|24025617|14745280|82906073|20990984|10498738|185017326|40024933|136293600|30508185|70415103|62053975|233332717|54564064|4941221|188304847|101172293|187614514|182355971|149746202|62267707|14936346|181549426|64667010|73040297|26363741|42549698|53689176|56401291|125334397|104091763|9400610|16240470|44382707|64664105|200489616|111036375|150286321|28214298|77976782|113071989|93633337|113469972|127199948|114014142|194398882|162052679|23764055|60001703|30552223|156249273|41363516|606300|82340459|45132761|83635851|2722174|186826655|180292989|54693492|74421253|84104941|215728762|25623554|53176926|116488231|74532402|1373549|95344054|121854741|39031088|1500692|33156823|18651456|26450968|208959107|86836612|63440331|24370527|28309316|68219714|118712788|89921752|88118171|76414044|47528235|83967917|49561482|54675974|5275826|152617299|211923697|98842323|20824450|144716673|75242053|27935359|76813772|124936293|42307630|110278154|43101446|49715777|95244024|32705724|18791137|88069044|149441736|10222279|127620154|101244849|80221780|33009528|42572228|73549758|20557954|45964480|63618535|9794573'
df[df['B'].astype(str).str.contains(matches)]
results.shape




results.to_csv('/Volumes/lesleydata/FinalProject/VCF/CrowdVar.LMC.tsv', sep='\t', header=None, index=False)
